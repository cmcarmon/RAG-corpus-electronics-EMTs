A powerful refinement to the technique involves cutting out filaments that have become too narrow to be significant. If the distance method of adding/removing points is used, then it is relatively straight forward to check the distances between all combinations of points. If a distance between non-adjacent points is too small, then the two points are separated from their neighbours, joined together and their neighbours joined also. Points may then be removed if necessary. Once we allow surgery, we allow multiply connected domains inside the same contour. A piece of the contour only one point in length would be removed from the simulation. The most challenging part of the exercise is keeping track of all the points in order to reduce the number of distance calculations---see nearest neighbour search. If the curvature method is used, then it may be difficult to recognize when two sections of the contour are close enough to apply the surgery because of differing spacing in strongly curved versus relatively straight sections.