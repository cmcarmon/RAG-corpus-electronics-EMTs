However, over large variations in distance, the approximation that g is constant is no longer valid, and we have to use calculus and the general mathematical definition of work to determine gravitational potential energy. For the computation of the potential energy we can integrate the gravitational force, whose magnitude is given by Newton's law of gravitation, with respect to the distance r between the two bodies. Using that definition, the gravitational potential energy of a system of masses m1 and M2 at a distance r using gravitational constant G is




U
=
−
G




m

1



M

2



r



+
K


{\displaystyle U=-G{\frac {m_{1}M_{2}}{r}}\ +K}
,
where K is an arbitrary constant dependent on the choice of datum from which potential is measured. Choosing the convention that K=0 (i.e. in relation to a point at infinity) makes calculations simpler, albeit at the cost of making U negative; for why this is physically reasonable, see below.
Given this formula for U, the total potential energy of a system of n bodies is found by summing, for all






n
(
n
−
1
)

2




{\displaystyle {\frac {n(n-1)}{2}}}
pairs of two bodies, the potential energy of the system of those two bodies.

Considering the system of bodies as the combined set of small particles the bodies consist of, and applying the previous on the particle level we get the negative gravitational binding energy. This potential energy is more strongly negative than the total potential energy of the system of bodies as such since it also includes the negative gravitational binding energy of each body. The potential energy of the system of bodies as such is the negative of the energy needed to separate the bodies from each other to infinity, while the gravitational binding energy is the energy needed to separate all particles from each other to infinity.




U
=
−
m

(

G



M

1



r

1




+
G



M

2



r

2





)



{\displaystyle U=-m\left(G{\frac {M_{1}}{r_{1}}}+G{\frac {M_{2}}{r_{2}}}\right)}

therefore,




U
=
−
m
∑
G


M
r




{\displaystyle U=-m\sum G{\frac {M}{r}}}
,