Cnoidal waves can be derived directly from the inviscid, irrotational and incompressible flow equations, and expressed in terms of three invariants of the flow, as shown by Benjamin & Lighthill (1954) in their research on undular bores. In a frame of reference moving with the phase speed, in which reference frame the flow becomes a steady flow, the cnoidal wave solutions can directly be related to the mass flux, momentum flux and energy head of the flow. Following Benjamin & Lighthill (1954)—using a stream function description of this incompressible flow—the horizontal and vertical components of the flow velocity are the spatial derivatives of the stream function Ψ(ξ,z): +∂zΨ and −∂ξΨ, in the ξ and z direction respectively (ξ = x−ct). The vertical coordinate z is positive in the upward direction, opposite to the direction of the gravitational acceleration, and the zero level of z is at the impermeable lower boundary of the fluid domain. While the free surface is at z = ζ(ξ); note that ζ is the local water depth, related to the surface elevation η(ξ) as ζ = h + η with h the mean water depth.
In this steady flow, the discharge Q through each vertical cross section is a constant independent of ξ, and because of the horizontal bed also the horizontal momentum flux S, divided by the density ρ, through each vertical cross section is conserved. Further, for this inviscid and irrotational flow, Bernoulli's principle can be applied and has the same Bernoulli constant R everywhere in the flow domain. They are defined as:








Q



=

∫

0


ζ
(
ξ
)



∂

z


Ψ


d

z
,




R



=


p
ρ


+



1
2






[




(


∂

ξ


Ψ

)


2


+


(


∂

z


Ψ

)


2




]


+
g

z


and





S



=

∫

0


ζ
(
ξ
)



[



p
ρ


+


(


∂

z


Ψ

)


2



]



d

z
.






{\displaystyle {\begin{aligned}Q&=\int _{0}^{\zeta (\xi )}\partial _{z}\Psi \;{\text{d}}z,\\R&={\frac {p}{\rho }}+{\tfrac {1}{2}}\,{\Bigl [}\left(\partial _{\xi }\Psi \right)^{2}+\left(\partial _{z}\Psi \right)^{2}{\Bigr ]}+g\,z\qquad {\text{and}}\\S&=\int _{0}^{\zeta (\xi )}\left[{\frac {p}{\rho }}+\left(\partial _{z}\Psi \right)^{2}\right]\;{\text{d}}z.\end{aligned}}}

For fairly long waves, assuming the water depth ζ is small compared to the wavelength λ, the following relation is obtained between the water depth ζ(ξ) and the three invariants Q, R and S:

This nonlinear and first-order ordinary differential equation has cnoidal wave solutions.
For very long waves of infinitesimal amplitude on a fluid of depth h and with a uniform flow velocity v, the flow constants are according to the shallow water equations:





Q

0


=
v

h
,


{\displaystyle Q_{0}=v\,h,}





R

0


=



1
2





v

2


+
g

h


{\displaystyle R_{0}={\tfrac {1}{2}}\,v^{2}+g\,h}
and




S

0


=

v

2



h
+



1
2




g


h

2


.


{\displaystyle S_{0}=v^{2}\,h+{\tfrac {1}{2}}\,g\,h^{2}.}

Equation (E) can be brought into non-dimensional form by use of the discharge Q and gravitational acceleration g, and defining the critical depth hc:





h

c


=




Q

2


g


3



,


{\displaystyle h_{c}={\sqrt[{3}]{\frac {Q^{2}}{g}}},}

related to the critical flow demarcation between subcritical flow and supercritical flow (see also Froude number). Consequently, the non-dimensional form of the equation is







1
3






(




ζ
~



′

)


2


≈
−

ζ

3


+
2




R
~








ζ
~




2


−
2




S
~







ζ
~



+
1
,


{\displaystyle {\tfrac {1}{3}}\,\left({\tilde {\zeta }}'\right)^{2}\approx -\zeta ^{3}+2\,{\tilde {R}}\,{\tilde {\zeta }}^{2}-2\,{\tilde {S}}\,{\tilde {\zeta }}+1,}

with







ζ
~



=


ζ

h

c




,


{\displaystyle {\tilde {\zeta }}={\frac {\zeta }{h_{c}}},}







ξ
~



=


ξ

h

c




,


{\displaystyle {\tilde {\xi }}={\frac {\xi }{h_{c}}},}







R
~



=


R

g


h

c





,


{\displaystyle {\tilde {R}}={\frac {R}{g\,h_{c}}},}
and






S
~



=


S

g


h

c


2





.


{\displaystyle {\tilde {S}}={\frac {S}{g\,h_{c}^{2}}}.}