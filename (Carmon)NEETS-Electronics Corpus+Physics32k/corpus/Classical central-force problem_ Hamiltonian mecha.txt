The radial force formula may also be derived using Hamiltonian mechanics. In polar coordinates, the Hamiltonian can be written as




H
=


1

2
m




(


p

r


2


+



p

φ


2



r

2





)

+
U
(
r
)


{\displaystyle H={\frac {1}{2m}}\left(p_{r}^{2}+{\frac {p_{\varphi }^{2}}{r^{2}}}\right)+U(r)}

Since the azimuthal angle φ does not appear in the Hamiltonian, its conjugate momentum pφ is a constant of the motion. This conjugate momentum is the magnitude L of the angular momentum, as shown by the Hamiltonian equation of motion for φ







d
φ


d
t



=



∂
H


∂

p

φ





=



p

φ



m

r

2





=


L

m

r

2







{\displaystyle {\frac {d\varphi }{dt}}={\frac {\partial H}{\partial p_{\varphi }}}={\frac {p_{\varphi }}{mr^{2}}}={\frac {L}{mr^{2}}}}

The corresponding equation of motion for r is







d
r


d
t



=



∂
H


∂

p

r





=



p

r


m




{\displaystyle {\frac {dr}{dt}}={\frac {\partial H}{\partial p_{r}}}={\frac {p_{r}}{m}}}

Taking the second derivative of r with respect to time and using Hamilton's equation of motion for pr yields the radial-force equation








d

2


r


d

t

2





=


1
m





d

p

r




d
t



=
−


1
m



(



∂
H


∂
r



)

=



p

φ


2




m

2



r

3





−


1
m





d
U


d
r



=



L

2




m

2



r

3





+


1
m


F
(
r
)


{\displaystyle {\frac {d^{2}r}{dt^{2}}}={\frac {1}{m}}{\frac {dp_{r}}{dt}}=-{\frac {1}{m}}\left({\frac {\partial H}{\partial r}}\right)={\frac {p_{\varphi }^{2}}{m^{2}r^{3}}}-{\frac {1}{m}}{\frac {dU}{dr}}={\frac {L^{2}}{m^{2}r^{3}}}+{\frac {1}{m}}F(r)}