It may be counterintuitive to find that the largest and (presumably) heaviest particles rise to the top, but several explanations are possible:
The center of mass of the whole system (containing the mixed nuts) in an arbitrary state is not optimally low; it has the tendency to be higher due to there being more empty space around the larger Brazil nuts than around smaller nuts. When the nuts are shaken, the system has the tendency to move to a lower energy state, which means moving the center of mass down by moving the smaller nuts down and thereby the Brazil nuts up.
Including the effects of air in spaces between particles, larger particles may become buoyant or sink. Smaller particles can fall into the spaces underneath a larger particle after each shake. Over time, the larger particle rises in the mixture. (According to Heinrich Jaeger, "[this] explanation for size separation might work in situations in which there is no granular convection, for example for containers with completely frictionless side walls or deep below the surface of tall containers (where convection is strongly suppressed). On the other hand, when friction with the side walls or other mechanisms set up a convection roll pattern inside the vibrated container, we found that the convective motion immediately takes over as the dominant mechanism for size separation.")
The same explanation without buoyancy or center of mass arguments: As a larger particle moves upward, any motion of smaller particles into the spaces underneath blocks the larger particle from settling back in its previous position. Repetitive motion results in more smaller particles slipping beneath larger particles. A greater density of the larger particles has no effect on this process. Shaking is not necessary; any process which raises particles and then lets them settle would have this effect. The process of raising the particles imparts potential energy into the system. The result of all the particles settling in a different order may be an increase in the potential energy—a raising of the center of mass.
When shaken, the particles move in vibration-induced convection flow; individual particles move up through the middle, across the surface, and down the sides. If a large particle is involved, it will be moved up to the top by convection flow. Once at the top, the large particle will stay there because the convection currents are too narrow to sweep it down along the wall.
The phenomenon is related to Parrondo's paradox in as much as the Brazil nuts move to the top of the mixed nuts against the gravitational gradient when subjected to random shaking.
Granular convection has been probed by the use of MRI  where convection rolls similar to those in fluids (Bénard cells) can be visualized.