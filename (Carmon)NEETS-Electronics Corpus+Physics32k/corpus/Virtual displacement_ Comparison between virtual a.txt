Here we consider the total differential of any set of system position vectors, ri, that are functions of other variables




{

q

1


,

q

2


,
.
.
.
,

q

m


}


{\displaystyle \lbrace q_{1},q_{2},...,q_{m}\rbrace }

and time t. These position vectors are "on-shell" meaning they satisfy the Euler-Lagrange equations and solve for the true evolution trajectories of the system. In another words, these vectors move according to the constraint forces and actual forces of the system at every instant in time. The actual displacement is the differential of the on-shell solution:




d


r


i


=



∂


r


i




∂
t



d
t
+

∑

j
=
1


m





∂


r


i




∂

q

j





d

q

j




{\displaystyle d\mathbf {r} _{i}={\frac {\partial \mathbf {r} _{i}}{\partial t}}dt+\sum _{j=1}^{m}{\frac {\partial \mathbf {r} _{i}}{\partial q_{j}}}dq_{j}}

Now, imagine if we have an arbitrary path through the configuration space/manifold. This means it has to satisfy the constraints of the system but not the actual applied forces. We can think of that as the off-shell differential:




δ


r


i


=

∑

j
=
1


m





∂


r


i




∂

q

j





δ

q

j




{\displaystyle \delta \mathbf {r} _{i}=\sum _{j=1}^{m}{\frac {\partial \mathbf {r} _{i}}{\partial q_{j}}}\delta q_{j}}

This equation is used in Lagrangian mechanics to relate generalized coordinates, qj, to virtual work, δW, and generalized forces, Qj.
In the two degree-of-freedom example on the right, the actual displacement is the true trajectory of the particle moving on the two-dimensional surface. The virtual displacement is any tangent vector to the surface.