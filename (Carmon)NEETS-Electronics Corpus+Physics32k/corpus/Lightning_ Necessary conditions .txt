In order for an electrostatic discharge to occur, two preconditions are necessary: firstly, a sufficiently high electric potential between two regions of space must exist, and secondly, a high-resistance medium must obstruct the free, unimpeded equalization of the opposite charges.
It is well understood that during a thunderstorm there is charge separation and aggregation in certain regions of the cloud; however the exact processes by which this occurs are not fully understood.
The atmosphere provides the electrical insulation, or barrier, that prevents free equalization between charged regions of opposite polarity. This is overcome by "lightning", a complex process referred to as the lightning "flash".