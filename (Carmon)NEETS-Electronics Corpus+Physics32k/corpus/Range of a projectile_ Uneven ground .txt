Now we will allow (y0) to be nonzero. Our equations of motion are now




x
(
t
)
=
v
t
cos
⁡
θ


{\displaystyle x(t)=vt\cos \theta }

and




y
(
t
)
=

y

0


+
v
t
sin
⁡
θ
−


1
2


g

t

2




{\displaystyle y(t)=y_{0}+vt\sin \theta -{\frac {1}{2}}gt^{2}}

Once again we solve for (t) in the case where the (y) position of the projectile is at zero (since this is how we defined our starting height to begin with)




0
=

y

0


+
v
t
sin
⁡
θ
−


1
2


g

t

2




{\displaystyle 0=y_{0}+vt\sin \theta -{\frac {1}{2}}gt^{2}}

Again by applying the quadratic formula we find two solutions for the time. After several steps of algebraic manipulation




t
=



v
sin
⁡
θ

g


±




v

2



sin

2


⁡
θ
+
2
g

y

0



g




{\displaystyle t={\frac {v\sin \theta }{g}}\pm {\frac {\sqrt {v^{2}\sin ^{2}\theta +2gy_{0}}}{g}}}

The square root must be a positive number, and since the velocity and the sine of the launch angle can also be assumed to be positive, the solution with the greater time will occur when the positive of the plus or minus sign is used. Thus, the solution is




t
=



v
sin
⁡
θ

g


+




v

2



sin

2


⁡
θ
+
2
g

y

0



g




{\displaystyle t={\frac {v\sin \theta }{g}}+{\frac {\sqrt {v^{2}\sin ^{2}\theta +2gy_{0}}}{g}}}

Solving for the range once again




d
=



v
cos
⁡
θ

g



[

v
sin
⁡
θ
+



v

2



sin

2


⁡
θ
+
2
g

y

0





]



{\displaystyle d={\frac {v\cos \theta }{g}}\left[v\sin \theta +{\sqrt {v^{2}\sin ^{2}\theta +2gy_{0}}}\right]}

or, equivalently




d
=



v

2



2
g




(

1
+


1
+



2
g


y

0





v

2



sin

2


⁡
θ







)

sin
⁡
2
θ


{\displaystyle d={\frac {v^{2}}{2g}}\left(1+{\sqrt {1+{\frac {2g\ y_{0}}{v^{2}\sin ^{2}\theta }}\ }}\right)\sin 2\theta }

To maximize the range at any height




θ
=
arccos
⁡




2
g

y

0


+

v

2




2
g

y

0


+
2

v

2








{\displaystyle \theta =\arccos {\sqrt {\frac {2gy_{0}+v^{2}}{2gy_{0}+2v^{2}}}}}

Checking the limit as




y

0




{\displaystyle y_{0}}
approaches 0





lim


y

0


→
0


arccos
⁡




2
g

y

0


+

v

2




2
g

y

0


+
2

v

2






=


π
4




{\displaystyle \lim _{y_{0}\to 0}\arccos {\sqrt {\frac {2gy_{0}+v^{2}}{2gy_{0}+2v^{2}}}}={\frac {\pi }{4}}}