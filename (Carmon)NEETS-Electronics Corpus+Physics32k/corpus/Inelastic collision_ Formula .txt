The formula for the velocities after a one-dimensional collision is:





v

a


=




C

R



m

b


(

u

b


−

u

a


)
+

m

a



u

a


+

m

b



u

b





m

a


+

m

b







{\displaystyle v_{a}={\frac {C_{R}m_{b}(u_{b}-u_{a})+m_{a}u_{a}+m_{b}u_{b}}{m_{a}+m_{b}}}}






v

b


=




C

R



m

a


(

u

a


−

u

b


)
+

m

a



u

a


+

m

b



u

b





m

a


+

m

b







{\displaystyle v_{b}={\frac {C_{R}m_{a}(u_{a}-u_{b})+m_{a}u_{a}+m_{b}u_{b}}{m_{a}+m_{b}}}}

where
va is the final velocity of the first object after impact
vb is the final velocity of the second object after impact
ua is the initial velocity of the first object before impact
ub is the initial velocity of the second object before impact
ma is the mass of the first object
mb is the mass of the second object
CR is the coefficient of restitution; if it is 1 we have an elastic collision; if it is 0 we have a perfectly inelastic collision, see below.
In a center of momentum frame the formulas reduce to:





v

a


=
−

C

R



u

a




{\displaystyle v_{a}=-C_{R}u_{a}}






v

b


=
−

C

R



u

b




{\displaystyle v_{b}=-C_{R}u_{b}}

For two- and three-dimensional collisions the velocities in these formulas are the components perpendicular to the tangent line/plane at the point of contact.
The normal impulse is:





J

n


=




m

a



m

b





m

a


+

m

b





(
1
+

C

R


)
(

u

b


−

u

a


)


{\displaystyle J_{n}={\frac {m_{a}m_{b}}{m_{a}+m_{b}}}(1+C_{R})(u_{b}-u_{a})}

Giving the velocity updates:




Δ




v

a


→



=



J

n



m

a








n

a


→





{\displaystyle \Delta {\vec {v_{a}}}={\frac {J_{n}}{m_{a}}}{\vec {n_{a}}}}





Δ




v

b


→



=



J

n



m

b








n

b


→





{\displaystyle \Delta {\vec {v_{b}}}={\frac {J_{n}}{m_{b}}}{\vec {n_{b}}}}