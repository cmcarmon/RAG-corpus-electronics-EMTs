The perifocal coordinate (PQW) system is a frame of reference for an orbit. The frame is centered at the focus of the orbit, i.e. the celestial body about which the orbit is centered. The unit vectors







p
^






{\displaystyle {\mathbf {\hat {p}} }}
and







q
^






{\displaystyle {\mathbf {\hat {q}} }}
lie in the plane of the orbit.







p
^






{\displaystyle {\mathbf {\hat {p}} }}
is directed towards the periapsis of the orbit and







q
^






{\displaystyle {\mathbf {\hat {q}} }}
has a true anomaly (



θ


{\displaystyle \theta }
) of 90 degrees past the periapsis. The third unit vector







w
^






{\displaystyle {\mathbf {\hat {w}} }}
is the angular momentum vector and is directed orthogonal to the orbital plane such that:








w
^




=




p
^




×




q
^






{\displaystyle {\mathbf {\hat {w}} }={\mathbf {\hat {p}} }\times {\mathbf {\hat {q}} }}

And, since







w
^






{\displaystyle {\mathbf {\hat {w}} }}
is the angular momentum vector, it may also be expressed as:







w
^



=



h


‖

h

‖





{\displaystyle \mathbf {\hat {w}} ={\frac {\mathbf {h} }{\|\mathbf {h} \|}}}

Where h is the specific relative angular momentum.
The position and velocity vectors can be determined for any location of the orbit. The position vector, r, can be expressed as:






r


=
‖
r
‖
cos
⁡
θ



p
^



+
‖
r
‖
sin
⁡
θ



q
^





{\displaystyle {\mathbf {r} }=\|r\|\cos \theta \mathbf {\hat {p}} +\|r\|\sin \theta \mathbf {\hat {q}} }

Where



θ


{\displaystyle \theta }
is the true anomaly and the radius r may be calculated from the orbit equation.
The velocity vector, v, is found by taking the time derivative of the position vector:






v


=




r
˙




=
(



r
˙



cos
⁡
θ
−
r



θ
˙



sin
⁡
θ
)




p
^




+
(



r
˙



sin
⁡
θ
+
r



θ
˙



cos
⁡
θ
)




q
^






{\displaystyle {\mathbf {v} }={\mathbf {\dot {r}} }=({\dot {r}}\cos \theta -r{\dot {\theta }}\sin \theta ){\mathbf {\hat {p}} }+({\dot {r}}\sin \theta +r{\dot {\theta }}\cos \theta ){\mathbf {\hat {q}} }}

A derivation from the orbit equation can be made to show that:







r
˙



=


μ
h


e
sin
⁡
θ


{\displaystyle {\dot {r}}={\frac {\mu }{h}}e\sin \theta }

where



μ


{\displaystyle \mu }
is the gravitational parameter of the focus, h is the specific relative angular momentum of the orbital body, e is the eccentricity of the orbit, and



θ


{\displaystyle \theta }
is the true anomaly.






r
˙





{\displaystyle {\dot {r}}}
is the radial component of the velocity vector (pointing inward toward the focus) and



r



θ
˙





{\displaystyle r{\dot {\theta }}}
is the tangential component of the velocity vector. By substituting the equations for






r
˙





{\displaystyle {\dot {r}}}
and



r



θ
˙





{\displaystyle r{\dot {\theta }}}
into the velocity vector equation and simplifying, the final form of the velocity vector equation is obtained as:






v


=


μ
h


[
−
sin
⁡
θ




p
^




+
(
e
+
cos
⁡
θ
)




q
^




]


{\displaystyle {\mathbf {v} }={\frac {\mu }{h}}[-\sin \theta {\mathbf {\hat {p}} }+(e+\cos \theta ){\mathbf {\hat {q}} }]}