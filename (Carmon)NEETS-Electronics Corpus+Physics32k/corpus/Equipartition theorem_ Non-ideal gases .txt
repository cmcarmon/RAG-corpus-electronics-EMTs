In an ideal gas the particles are assumed to interact only through collisions. The equipartition theorem may also be used to derive the energy and pressure of "non-ideal gases" in which the particles also interact with one another through conservative forces whose potential U(r) depends only on the distance r between the particles. This situation can be described by first restricting attention to a single gas particle, and approximating the rest of the gas by a spherically symmetric distribution. It is then customary to introduce a radial distribution function g(r) such that the probability density of finding another particle at a distance r from the given particle is equal to 4πr2ρg(r), where ρ = N/V is the mean density of the gas. It follows that the mean potential energy associated to the interaction of the given particle with the rest of the gas is




⟨

h


p
o
t



⟩
=

∫

0


∞


4
π

r

2


ρ
U
(
r
)
g
(
r
)

d
r
.


{\displaystyle \langle h_{\mathrm {pot} }\rangle =\int _{0}^{\infty }4\pi r^{2}\rho U(r)g(r)\,dr.}

The total mean potential energy of the gas is therefore



⟨

H

p
o
t


⟩
=



1
2



N
⟨

h


p
o
t



⟩


{\displaystyle \langle H_{pot}\rangle ={\tfrac {1}{2}}N\langle h_{\mathrm {pot} }\rangle }
, where N is the number of particles in the gas, and the factor ​1⁄2 is needed because summation over all the particles counts each interaction twice. Adding kinetic and potential energies, then applying equipartition, yields the energy equation




H
=
⟨

H


k
i
n



⟩
+
⟨

H


p
o
t



⟩
=


3
2


N

k

B


T
+
2
π
N
ρ

∫

0


∞



r

2


U
(
r
)
g
(
r
)

d
r
.


{\displaystyle H=\langle H_{\mathrm {kin} }\rangle +\langle H_{\mathrm {pot} }\rangle ={\frac {3}{2}}Nk_{B}T+2\pi N\rho \int _{0}^{\infty }r^{2}U(r)g(r)\,dr.}

A similar argument, can be used to derive the pressure equation




3
N

k


B



T
=
3
P
V
+
2
π
N
ρ

∫

0


∞



r

3



U
′

(
r
)
g
(
r
)

d
r
.


{\displaystyle 3Nk_{\rm {B}}T=3PV+2\pi N\rho \int _{0}^{\infty }r^{3}U'(r)g(r)\,dr.}